# TRIVIA CHALLENGER

## Heroku Link
https://jaclynyfinalproject.herokuapp.com/ 
## Video Links
https://drive.google.com/file/d/1hW22KzjkpIm0uh3T9PbKLTdXw4VJLPpu/view?usp=drivesdk 
## Description
TRIVIA CHALLENGER is a trivia game where players race against the clock to correctly answer as many trivia questions as possible. After entering your name, the game begins a 60 second or 1 minute countdown. You can then select the category and difficulty of each of your upcoming questions. The number of points you earn or lose depends on the question difficulty and answer correctness. Questions of higher difficulty will be worth more and questions of lower difficulty will be worth less (Easy: 10 pts, Medium: 30 pts, Hard: 50 pts). If a question is answered correctly, you will receive the number of points the question was worth. If a question is answered incorrectly, that same number of points will be deducted from your score. Your final score will be the number of points you have at the end when the timer reaches zero. Your rank and the current reigning champions are also displayed at the end. This final project is meant to serve as both a form of entertainment and education. The player will have fun challenging themselves to improve their rank and defeat the current reigning champions. At the same, they will be learning many interesting facts as they answer the trivia questions.  
## Client-Side and Server-Side
Part of the client-side programming in this application includes the pug files that define what information and what structure is displayed on each of the pages. The buttons that the player can interacts with sends various GET and POST requests to the server to handle. The `style.css` file is also on the client-side to specify how the contents on each of the pages are styled. The `timer.js` file is the other component of the client-side. This file includes the `setInterval` programming for the countdown timer that also updates the HTML display to accurately reflect the amount of time left for the player. Once time is up, it sends a GET request to the server to route to the rankings page. The timer functionality also needs to be linked to the server-side to accurately pass the time remaining from one page to another. In order for the time to be communicated between the two sides, the time was consistently stored, updated, and read in a cookie from either side. 

The server-side of the application is essentially everything in the `index.js` file. This file contains all the programming to properly handle any GET (`/` and `/rankings`) and POST (`selection`, `/question`, `/check`) requests that the player or client-side sends. This file also contains the aspects of code that interact and query the MongoDB database to update and store the scores of everyone who has played the game before.
## APIs and Contributed Modules
My application interacts primarily with the GET method from the Open Trivia Database API. Access to this API was needed in the `getQuestion` function in order to fetch a random question given the player's selected category and difficulty. The URL used to GET from the API is generated as follows: "h<span>ttps://opentdb.com/api.php?amount=1&category=" + category + "&difficulty=" + difficulty. Some contributed modules I used in this application include the `he` module for decoding the HTML entities and the `axios` module for fetching from API URLs. I also used the `jest` and `supertest` modules for unit testing.
## MVC
Model: The model of this application exists primarily in the form of the player's name, score, and time remaining being stored in cookies, as well as the information stored about the current question. The business logic of the application's model exists in the form of a few functions. The `categoryIndex` function gives the logic for determining the corresponding index of the selected category. The `decode` function converts the question and answer texts into a more readable form by decoding the HTML entities. The `makeChoices` function randomly inserts the correct answer into an array of the incorrect answer choices. Finally, the `getPoints` function determines how many points a question is worth depending on the difficulty level. 

View: The views in my application include all the pug files. The `layout.pug` file includes all the metadata for the application as well as the links to the styling. The `error.pug` defines how the application will display any errors. The `index.pug` file lays out the appearance of the home page where the player enters their name. The `selection.pug` file provides the buttons for the player to select the category and difficulty of their next question. The `question.pug` file displays the randomly chosen question and the possible answer choices. The `rankings.pug` file displays the player's final score and the reigning champions of the game. The overall style of the application is considered "fun" with contrasting and bright colors for a retro appearance. 

Controller: The controllers in the application are essentially the POST and GET methods. A `/` GET method exists for directing the player to the home page. A `/selection` POST method is used to record the player's name and restart the time cookie to store the 1 minute time limit, before rendering the selection page. The `/question` POST method records the category and difficulty selected by the player and then makes a call to retrieve a random question from the API. The `getQuestion` function also acts as a controller as it defines the process logic in fetching a question from the API. The `/question` POST method then calls the `makeChoices` function to generate the answer choices and renders the question page. The `/check` POST method checks whether the player's answer was correct and updates the score for the player accordingly before going back to the selection page. The `/rankings` GET method queries the database to calculate the player's final ranking and determines the top three reigning champions before rendering the rankings page. In the `timer.js` file, the `setInterval` and `getTime` functions works together as another controller to update the time remaining as needed. 
## Cookies
One way my application uses cookies is to help store information that is needed by multiple different methods in the `index.js` file. For example, the `/question` POST method records the difficulty selection from the user and the correct answer from the API. However, both pieces of information are needed later in the `/check` POST method to check whether the player's answer choice was correct and update their score accordingly. The player's name and score are also stored in a similar way. Using cookies eliminates the need for multiple global variables. A cookie is also used to power the countdown timer functionality of the application. The server-side dictates the amount of time to begin with and passes the time remaining to other pages when they render. The client-side code does the actual countdown using a setInterval function and updates the HTML every second to show the new amount of time remaining. In order for the server and client to communicate properly and display the time remaining across different pages with consistency, a cookie is used to that they can both read and write to it. 
## Database
The application I built relies on the MongoDB database for storing all past players and their scores. Each document in the database is identified by the name of the player. I did this so that the playerâ€™s name would function somewhat similarly to a username (true account/username authentication was not implemented). Whenever a player plays, their score is updated to their new current score if they already exist in the database. Otherwise, a new record is inserted for the player. These pieces of information are stored in order to help determine how the player currently ranks against everyone who has played in the past. By sorting the documents by their score, the application can calculate the rank of the given player based on where they appear. Counting all the documents helps determine the total number of players for better ranking context. Lastly, the database also makes it possible to display the current reigning champions and how well they scored by sorting and limiting the documents. This provides information for people curious in knowing how well they need to score in order to reach the top.
## HTML Validation
Home Page

Selection Page

Question Page

Ranking Page
